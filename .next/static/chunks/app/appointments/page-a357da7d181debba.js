(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[921],{2048:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(5155),a=s(2115),n=s(5695),o=s(5168),i=s(42),l=s(7387),d=s(351),c=s(8756);let m=()=>{let e=(0,n.useRouter)(),{theme:t}=(0,i.D)(),[s,m]=(0,a.useState)("pt"),[p,x]=(0,a.useState)([]),[u,h]=(0,a.useState)("user"),[g,b]=(0,a.useState)(!0),[f,v]=(0,a.useState)(null),y=async()=>{b(!0),v(null);try{let t=(0,o.U)(),{data:{user:s}}=await t.auth.getUser();if(!s)return void e.push("/login");let{data:r,error:a}=await t.from("user_profiles").select("role").eq("id",s.id).single();!a&&r&&h(r.role||"user");let n=t.from("appointments_with_details").select("*").order("appointment_date",{ascending:!0}).order("start_time",{ascending:!0});"admin"===u||(n=n.eq("user_id",s.id));let{data:i,error:l}=await n;l?(console.error("Error fetching appointments:",l),v("Error loading appointments")):x(i||[])}catch(e){console.error("Error fetching appointments:",e),v("Error loading appointments")}finally{b(!1)}};(0,a.useEffect)(()=>{y()},[]);let j={en:{myAppointments:"admin"===u?"All Appointments":"My Appointments",bookAppointment:"Book Appointment",noAppointments:"No appointments",noAppointmentsDesc:"Get started by booking your first appointment.",reschedule:"Reschedule",cancel:"Cancel",markCompleted:"Mark as Completed",home:"Home",appointments:"Appointments",profile:"Profile",logout:"Logout",barber:"Barber",confirmed:"Confirmed",pending:"Pending",cancelled:"Cancelled",scheduled:"Scheduled",completed:"Completed",noShow:"No Show",loading:"Loading appointments...",errorLoading:"Error loading appointments",retry:"Retry",services:"Services",client:"Client",date:"Date",time:"Time",status:"Status",location:"Location",notes:"Notes"},es:{myAppointments:"admin"===u?"Todas las Citas":"Mis Citas",bookAppointment:"Reservar Cita",noAppointments:"Sin citas",noAppointmentsDesc:"Comienza reservando tu primera cita.",reschedule:"Reprogramar",cancel:"Cancelar",markCompleted:"Marcar como Completado",home:"Inicio",appointments:"Citas",profile:"Perfil",logout:"Cerrar Sesi\xf3n",barber:"Barbero",confirmed:"Confirmado",pending:"Pendiente",cancelled:"Cancelado",scheduled:"Programado",completed:"Completada",noShow:"No Present\xf3",loading:"Cargando citas...",errorLoading:"Error al cargar citas",retry:"Reintentar",services:"Servicios",client:"Cliente",date:"Fecha",time:"Hora",status:"Estado",location:"Ubicaci\xf3n",notes:"Notas"},pt:{myAppointments:"admin"===u?"Todos os Agendamentos":"Meus Agendamentos",bookAppointment:"Agendar Hor\xe1rio",noAppointments:"Nenhum agendamento",noAppointmentsDesc:"Comece agendando seu primeiro hor\xe1rio.",reschedule:"Reagendar",cancel:"Cancelar",markCompleted:"Marcar como Conclu\xeddo",home:"In\xedcio",appointments:"Agendamentos",profile:"Perfil",logout:"Sair",barber:"Barbeiro",confirmed:"Confirmado",pending:"Pendente",cancelled:"Cancelado",scheduled:"Agendado",completed:"Conclu\xeddo",noShow:"N\xe3o Compareceu",loading:"Carregando agendamentos...",errorLoading:"Erro ao carregar agendamentos",retry:"Tentar novamente",services:"Servi\xe7os",client:"Cliente",date:"Data",time:"Hor\xe1rio",status:"Status",location:"Local",notes:"Observa\xe7\xf5es"},fr:{myAppointments:"admin"===u?"Tous les Rendez-vous":"Mes Rendez-vous",bookAppointment:"Prendre Rendez-vous",noAppointments:"Aucun rendez-vous",noAppointmentsDesc:"Commencez par prendre votre premier rendez-vous.",reschedule:"Reprogrammer",cancel:"Annuler",markCompleted:"Marquer comme Termin\xe9",home:"Accueil",appointments:"Rendez-vous",profile:"Profil",logout:"D\xe9connexion",barber:"Barbier",confirmed:"Confirm\xe9",pending:"En attente",cancelled:"Annul\xe9",scheduled:"Programm\xe9",completed:"Termin\xe9",noShow:"Absent",loading:"Chargement des rendez-vous...",errorLoading:"Erreur lors du chargement des rendez-vous",retry:"R\xe9essayer",services:"Services",client:"Client",date:"Date",time:"Heure",status:"Statut",location:"Lieu",notes:"Notes"}}[s];(0,a.useEffect)(()=>{document.documentElement.lang=s},[s]);let k=e=>{switch(e){case"confirmed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"pending":case"scheduled":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},N=e=>{switch(e){case"confirmed":return j.confirmed;case"pending":return j.pending;case"scheduled":return j.scheduled;case"cancelled":return j.cancelled;case"completed":return j.completed;case"no_show":return j.noShow;default:return e.charAt(0).toUpperCase()+e.slice(1)}},w=e=>e?new Date("2000-01-01T".concat(e)).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",C=e=>e?(0,c.x)(e):"",A=async()=>{try{let t=(0,o.U)();await t.auth.signOut(),e.push("/login")}catch(e){console.error("Error signing out:",e)}},_=async(e,t)=>{try{let s=(0,o.U)(),{error:r}=await s.from("appointments").update({status:t}).eq("id",e);if(r)return void console.error("Error updating appointment status:",r);await y()}catch(e){console.error("Error updating appointment status:",e)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100 dark:from-gray-900 dark:via-slate-800 dark:to-gray-900",children:[(0,r.jsx)(l.sm,{language:s,onLanguageChange:m,onLogout:A,userRole:u}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:py-8 px-4 sm:px-6 lg:px-8",children:g?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(d.TwU,{className:"mx-auto h-8 w-8 animate-spin text-blue-600"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:j.loading})]})}):f?(0,r.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,r.jsx)("div",{className:"mx-auto h-12 w-12 text-red-500 mb-4",children:(0,r.jsx)(d.wIk,{className:"h-full w-full"})}),(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:j.errorLoading}),(0,r.jsx)("button",{onClick:y,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors",children:j.retry})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl sm:text-2xl text-center font-bold text-gray-900 dark:text-white",children:j.myAppointments}),(0,r.jsxs)("button",{onClick:()=>e.push("/appointments/new"),className:"flex items-center justify-center space-x-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm w-full sm:w-auto",children:[(0,r.jsx)(d.GGD,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:j.bookAppointment})]})]}),(0,r.jsx)("div",{className:"space-y-4",children:0===p.length?(0,r.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,r.jsx)(d.wIk,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:j.noAppointments}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:j.noAppointmentsDesc}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)("button",{onClick:()=>e.push("/appointments/new"),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(d.GGD,{className:"w-4 h-4 mr-2"}),j.bookAppointment]})})]}):p.map(e=>(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-sm rounded-lg p-4 sm:p-6 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"sm:hidden",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white pr-2",children:e.title}),(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(k(e.status)," ").concat("admin"===u&&"completed"!==e.status&&"cancelled"!==e.status?"cursor-pointer hover:opacity-80 transition-opacity hover:scale-105":""),onClick:"admin"===u&&"completed"!==e.status&&"cancelled"!==e.status?()=>_(e.id,"completed"):void 0,title:"admin"===u&&"completed"!==e.status&&"cancelled"!==e.status?j.markCompleted:void 0,children:N(e.status)})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-500 dark:text-gray-400 mb-4",children:[e.client_name&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.JXP,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,r.jsxs)("span",{children:[j.client,": ",e.client_name]})]}),e.service_name&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.wIk,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,r.jsxs)("span",{children:[j.services,": ",e.service_name]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.Ohp,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,r.jsxs)("span",{children:[C(e.appointment_date)," at ",w(e.start_time)]})]}),e.location&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.HzC,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,r.jsx)("span",{children:e.location})]})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{className:"flex-1 px-3 py-2 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 border border-blue-200 dark:border-blue-700 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",children:j.reschedule}),(0,r.jsx)("button",{className:"flex-1 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 border border-red-200 dark:border-red-700 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:j.cancel})]})]}),(0,r.jsxs)("div",{className:"hidden sm:flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:e.title}),(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(k(e.status)," ").concat("admin"===u&&"completed"!==e.status&&"cancelled"!==e.status?"cursor-pointer hover:opacity-80 transition-opacity hover:scale-105":""),onClick:"admin"===u&&"completed"!==e.status&&"cancelled"!==e.status?()=>_(e.id,"completed"):void 0,title:"admin"===u&&"completed"!==e.status&&"cancelled"!==e.status?j.markCompleted:void 0,children:N(e.status)})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-500 dark:text-gray-400",children:[e.client_name&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.JXP,{className:"w-4 h-4 mr-2"}),(0,r.jsxs)("span",{children:[j.client,": ",e.client_name]})]}),e.service_name&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.wIk,{className:"w-4 h-4 mr-2"}),(0,r.jsxs)("span",{children:[j.services,": ",e.service_name]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.Ohp,{className:"w-4 h-4 mr-2"}),(0,r.jsxs)("span",{children:[C(e.appointment_date)," at ",w(e.start_time)]})]}),e.location&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.HzC,{className:"w-4 h-4 mr-2"}),(0,r.jsx)("span",{children:e.location})]})]})]}),(0,r.jsxs)("div",{className:"ml-6 flex space-x-2",children:[(0,r.jsx)("button",{className:"px-3 py-1 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:j.reschedule}),(0,r.jsx)("button",{className:"px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 transition-colors",children:j.cancel})]})]})]},e.id))})]})})]})},p=()=>(0,r.jsx)(m,{})},9374:(e,t,s)=>{Promise.resolve().then(s.bind(s,2048))}},e=>{e.O(0,[844,242,503,441,964,358],()=>e(e.s=9374)),_N_E=e.O()}]);