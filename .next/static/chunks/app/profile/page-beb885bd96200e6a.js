(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{903:(e,a,r)=>{Promise.resolve().then(r.bind(r,8591))},8591:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>c});var t=r(5155),o=r(2115),s=r(5695),l=r(351),n=r(5168),d=r(7387),i=r(8756);let c=()=>{let e=(0,s.useRouter)(),[a,r]=(0,o.useState)(null),[c,u]=(0,o.useState)("user"),[g,m]=(0,o.useState)(!1),[f,h]=(0,o.useState)(!0),[x,p]=(0,o.useState)(!1),[b,y]=(0,o.useState)(null),[k,v]=(0,o.useState)(null),[j,N]=(0,o.useState)("pt"),[w,_]=(0,o.useState)({full_name:"",email:"",phone:"",address:"",city:"",state:"",country:"",postal_code:"",date_of_birth:"",gender:""}),C={en:{title:"admin"===c?"All Users":"Profile",subtitle:"admin"===c?"Manage all user profiles":"Manage your personal information",personalInfo:"Personal Information",contactInfo:"Contact Information",addressInfo:"Address Information",editProfile:"Edit Profile",saveChanges:"Save Changes",cancel:"Cancel",backToDashboard:"Back to Dashboard",profileUpdated:"Profile updated successfully!",errorUpdating:"Error updating profile. Please try again.",loading:"Loading...",noData:"No data available",name:"Full Name",email:"Email",phone:"Phone",address:"Address",city:"City",state:"State",country:"Country",postalCode:"Postal Code",dateOfBirth:"Date of Birth",gender:"Gender",male:"Male",female:"Female",other:"Other",preferNotToSay:"Prefer not to say"},pt:{title:"admin"===c?"Todos os Usu\xe1rios":"Perfil",subtitle:"admin"===c?"Gerencie todos os perfis de usu\xe1rios":"Gerencie suas informa\xe7\xf5es pessoais",personalInfo:"Informa\xe7\xf5es Pessoais",contactInfo:"Informa\xe7\xf5es de Contato",addressInfo:"Informa\xe7\xf5es de Endere\xe7o",editProfile:"Editar",saveChanges:"Salvar Altera\xe7\xf5es",cancel:"Cancelar",backToDashboard:"Voltar ao Dashboard",profileUpdated:"Perfil atualizado com sucesso!",errorUpdating:"Erro ao atualizar perfil. Tente novamente.",loading:"Carregando...",noData:"Nenhum dado dispon\xedvel",name:"Nome Completo",email:"Email",phone:"Telefone",address:"Endere\xe7o",city:"Cidade",state:"Estado",country:"Pa\xeds",postalCode:"CEP",dateOfBirth:"Data de Nascimento",gender:"G\xeanero",male:"Masculino",female:"Feminino",other:"Outro",preferNotToSay:"Prefiro n\xe3o dizer"},es:{title:"admin"===c?"Todos los Usuarios":"Perfil",subtitle:"admin"===c?"Gestiona todos los perfiles de usuarios":"Gestiona tu informaci\xf3n personal",personalInfo:"Informaci\xf3n Personal",contactInfo:"Informaci\xf3n de Contacto",addressInfo:"Informaci\xf3n de Direcci\xf3n",editProfile:"Editar Perfil",saveChanges:"Guardar Cambios",cancel:"Cancelar",backToDashboard:"Volver al Dashboard",profileUpdated:"\xa1Perfil actualizado exitosamente!",errorUpdating:"Error al actualizar perfil. Intenta de nuevo.",loading:"Cargando...",noData:"No hay datos disponibles",name:"Nombre Completo",email:"Email",phone:"Tel\xe9fono",address:"Direcci\xf3n",city:"Ciudad",state:"Estado",country:"Pa\xeds",postalCode:"C\xf3digo Postal",dateOfBirth:"Fecha de Nacimiento",gender:"G\xe9nero",male:"Masculino",female:"Femenino",other:"Otro",preferNotToSay:"Prefiero no decir"},fr:{title:"admin"===c?"Tous les Utilisateurs":"Profil",subtitle:"admin"===c?"G\xe9rez tous les profils utilisateurs":"G\xe9rez vos informations personnelles",personalInfo:"Informations Personnelles",contactInfo:"Informations de Contact",addressInfo:"Informations d'Adresse",editProfile:"Modifier le Profil",saveChanges:"Enregistrer les Modifications",cancel:"Annuler",backToDashboard:"Retour au Tableau de Bord",profileUpdated:"Profil mis \xe0 jour avec succ\xe8s!",errorUpdating:"Erreur lors de la mise \xe0 jour du profil. Veuillez r\xe9essayer.",loading:"Chargement...",noData:"Aucune donn\xe9e disponible",name:"Nom Complet",email:"Email",phone:"T\xe9l\xe9phone",address:"Adresse",city:"Ville",state:"\xc9tat",country:"Pays",postalCode:"Code Postal",dateOfBirth:"Date de Naissance",gender:"Genre",male:"Masculin",female:"F\xe9minin",other:"Autre",preferNotToSay:"Pr\xe9f\xe8re ne pas dire"}}[j];(0,o.useEffect)(()=>{document.documentElement.lang=j},[j]),(0,o.useEffect)(()=>{P()},[]);let P=async()=>{h(!0),y(null);let a=(0,n.U)();try{let{data:{user:s}}=await a.auth.getUser();if(!s)return void e.push("/login");let{data:l,error:n}=await a.from("user_profiles").select("*").eq("id",s.id).single();if(n)if(console.error("Error fetching profile:",n),console.error("Error details:",{message:n.message,details:n.details,hint:n.hint,code:n.code}),"PGRST116"===n.code){var t,o;console.log("Profile not found, creating new profile...");let{data:e,error:l}=await a.from("user_profiles").insert({id:s.id,email:s.email,full_name:(null==(t=s.user_metadata)?void 0:t.full_name)||(null==(o=s.email)?void 0:o.split("@")[0])||"User",role:"user"}).select().single();l?(console.error("Error creating profile:",l),y(C.errorUpdating)):(r(e),u(e.role||"user"),_({full_name:e.full_name||"",email:e.email||"",phone:e.phone||"",address:e.address||"",city:e.city||"",state:e.state||"",country:e.country||"",postal_code:e.postal_code||"",date_of_birth:e.date_of_birth||"",gender:e.gender||""}))}else y(C.errorUpdating);else r(l),u(l.role||"user"),_({full_name:l.full_name||"",email:l.email||"",phone:l.phone||"",address:l.address||"",city:l.city||"",state:l.state||"",country:l.country||"",postal_code:l.postal_code||"",date_of_birth:l.date_of_birth||"",gender:l.gender||""})}catch(e){console.error("Error fetching profile:",e),y(C.errorUpdating)}finally{h(!1)}},E=async()=>{p(!0),y(null),v(null);let a=(0,n.U)();try{let{data:{user:r}}=await a.auth.getUser();if(!r)return void e.push("/login");let{error:t}=await a.from("user_profiles").update({full_name:w.full_name,phone:w.phone,address:w.address,city:w.city,state:w.state,country:w.country,postal_code:w.postal_code,date_of_birth:w.date_of_birth||null,gender:w.gender||null}).eq("id",r.id);t?(console.error("Error updating profile:",t),y(C.errorUpdating)):(v(C.profileUpdated),m(!1),await P())}catch(e){console.error("Error updating profile:",e),y(C.errorUpdating)}finally{p(!1)}},I=e=>{let{name:a,value:r}=e.target;_(e=>({...e,[a]:r}))},D=async()=>{let a=(0,n.U)();await a.auth.signOut(),e.push("/login")};return f?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:C.loading})]})})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[(0,t.jsx)(d.sm,{language:j,onLanguageChange:N,onLogout:D,title:C.title,userRole:c,showBackButton:!0,backButtonText:C.backToDashboard}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[b&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg",children:(0,t.jsx)("p",{className:"text-red-600 dark:text-red-400 text-sm",children:b})}),k&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-lg",children:(0,t.jsx)("p",{className:"text-green-600 dark:text-green-400 text-sm",children:k})}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:g?C.editProfile:C.personalInfo}),g?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("button",{onClick:()=>{m(!1),_({full_name:(null==a?void 0:a.full_name)||"",email:(null==a?void 0:a.email)||"",phone:(null==a?void 0:a.phone)||"",address:(null==a?void 0:a.address)||"",city:(null==a?void 0:a.city)||"",state:(null==a?void 0:a.state)||"",country:(null==a?void 0:a.country)||"",postal_code:(null==a?void 0:a.postal_code)||"",date_of_birth:(null==a?void 0:a.date_of_birth)||"",gender:(null==a?void 0:a.gender)||""})},className:"flex items-center space-x-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200",children:[(0,t.jsx)(l.yGN,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:C.cancel})]}),(0,t.jsxs)("button",{onClick:E,disabled:x,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 disabled:opacity-50",children:[(0,t.jsx)(l.Bc_,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:x?C.loading:C.saveChanges})]})]}):(0,t.jsxs)("button",{onClick:()=>m(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[(0,t.jsx)(l.SG1,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:C.editProfile})]})]}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h4",{className:"text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2",children:C.personalInfo}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.name}),g?(0,t.jsx)("input",{type:"text",name:"full_name",value:w.full_name,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(null==a?void 0:a.full_name)||C.noData})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.email}),(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(null==a?void 0:a.email)||C.noData})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.phone}),g?(0,t.jsx)("input",{type:"tel",name:"phone",value:w.phone,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(null==a?void 0:a.phone)||C.noData})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.dateOfBirth}),g?(0,t.jsx)("input",{type:"date",name:"date_of_birth",value:w.date_of_birth,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(e=>e?(0,i.x)(e):C.noData)((null==a?void 0:a.date_of_birth)||"")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.gender}),g?(0,t.jsxs)("select",{name:"gender",value:w.gender,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"",children:C.preferNotToSay}),(0,t.jsx)("option",{value:"male",children:C.male}),(0,t.jsx)("option",{value:"female",children:C.female}),(0,t.jsx)("option",{value:"other",children:C.other})]}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(e=>{switch(e){case"male":return C.male;case"female":return C.female;case"other":return C.other;case"prefer_not_to_say":return C.preferNotToSay;default:return C.noData}})((null==a?void 0:a.gender)||"")})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h4",{className:"text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2",children:C.addressInfo}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.address}),g?(0,t.jsx)("input",{type:"text",name:"address",value:w.address,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(null==a?void 0:a.address)||C.noData})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.city}),g?(0,t.jsx)("input",{type:"text",name:"city",value:w.city,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(null==a?void 0:a.city)||C.noData})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.state}),g?(0,t.jsx)("input",{type:"text",name:"state",value:w.state,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(null==a?void 0:a.state)||C.noData})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.country}),g?(0,t.jsx)("input",{type:"text",name:"country",value:w.country,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(null==a?void 0:a.country)||C.noData})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:C.postalCode}),g?(0,t.jsx)("input",{type:"text",name:"postal_code",value:w.postal_code,onChange:I,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}):(0,t.jsx)("p",{className:"text-gray-900 dark:text-white",children:(null==a?void 0:a.postal_code)||C.noData})]})]})]})})]})]})]})}}},e=>{e.O(0,[844,242,503,441,964,358],()=>e(e.s=903)),_N_E=e.O()}]);